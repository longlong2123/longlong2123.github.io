import{_ as $,r as f,u as j,c as E,a as B,b as g,t as C,d as i,w as y,e as M,E as N,f as R,o as A,F as D,g as H,h as L,i as P,j as W,k as Z,l as J,m as X,n as q,p as Q}from"./index-CBiQ7PuV.js";/* empty css                 *//* empty css                *//* empty css                  */import{C as l}from"./index-DPbzdMkA.js";import{s as K}from"./index-DPwbbWco.js";import{C as U}from"./copy_textarea-DctNTAp4.js";const x={standardizeKey(a){const e=new TextEncoder().encode(a);if(e.length===32)return e;if(e.length<32){const t=new Uint8Array(32);return t.set(e),t}else return e.slice(0,32)},async encrypt(a,n){try{const e=new TextEncoder,t=this.standardizeKey(n),d=await crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt"]),r=crypto.getRandomValues(new Uint8Array(12)),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},d,e.encode(a)),c=new Uint8Array(r.length+o.byteLength);return c.set(r,0),c.set(new Uint8Array(o),r.length),btoa(String.fromCharCode.apply(null,c))}catch(e){throw e}},async decrypt(a,n){try{const e=this.standardizeKey(n),t=await crypto.subtle.importKey("raw",e,{name:"AES-GCM"},!1,["decrypt"]),d=Uint8Array.from(atob(a),u=>u.charCodeAt(0)),r=d.slice(0,12),o=d.slice(12),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,o);return new TextDecoder().decode(c)}catch(e){throw e}}},V=256,Y=128,O=100,T={encrypt(a,n,e={}){var t=l.lib.WordArray.random(16),d=l.PBKDF2(n,t,{keySize:V/32,iterations:O}),r=l.lib.WordArray.random(Y/8);const{padding:o,mode:c}=e,u=this.getMode(c),v=this.getPadding(o);var m=l.AES.encrypt(a,d,{iv:r,padding:v,mode:u,hasher:l.algo.SHA256}),S=t.toString()+r.toString()+m.toString();return S},decrypt(a,n,e={}){const{padding:t,mode:d}=e,r=this.getMode(d),o=this.getPadding(t);var c=l.enc.Hex.parse(a.substr(0,32)),u=l.enc.Hex.parse(a.substr(32,32)),v=a.substring(64),m=l.PBKDF2(n,c,{keySize:V/32,iterations:O}),S=l.AES.decrypt(v,m,{iv:u,padding:o,mode:r,hasher:l.algo.SHA256});return S.toString(l.enc.Utf8)},getMode(a){switch(a.toUpperCase()){case"ECB":return l.mode.ECB;case"CBC":return l.mode.CBC;case"CFB":return l.mode.CFB;case"OFB":return l.mode.OFB;case"CTR":return l.mode.CTR;default:throw new Error("Unsupported encryption mode")}},getPadding(a){switch(a.toUpperCase()){case"PKCS7":return l.pad.Pkcs7;case"ISO97971":return l.pad.Iso97971;case"ANSIÐ¥923":return l.pad.AnsiX923;case"ISO10126":return l.pad.Iso10126;case"ZEROPADDING":return l.pad.ZeroPadding;case"NOPADDING":return l.pad.NoPadding;default:return l.pad.Pkcs7}}},G={generateRandomHexString(a){const n="0123456789abcdef";let e="";for(let t=0;t<a;t++){const d=Math.floor(Math.random()*n.length);e+=n[d]}return e},standardizeKey(a){let e=new TextEncoder().encode(a);if(e.length<16){const d=new Uint8Array(16);d.set(e),e=d}else e.length>16&&(e=e.slice(0,16));let t="";return e.forEach(d=>{t+=d.toString(16).padStart(2,"0")}),t},encrypt(a,n,e={}){const{padding:t,mode:d}=e,r=this.getMode(d),o=this.getPadding(t),c=r!=="ecb"?this.generateRandomHexString(32):null,u={mode:r,padding:o,iv:c},v=K.sm4.encrypt(a,this.standardizeKey(n),u);let m;return c?m=`${c}${v}`:m=v,m},decrypt(a,n,e={}){const{padding:t,mode:d}=e,r=this.getMode(d),o=this.getPadding(t);let c,u;r!=="ecb"?(c=a.slice(0,32),u=a.slice(32)):(c=null,u=a);const v={mode:r,padding:o,iv:c};return K.sm4.decrypt(u,this.standardizeKey(n),v)},getMode(a){switch(a.toUpperCase()){case"ECB":return"ecb";case"CBC":return"cbc";default:throw new Error("Unsupported encryption mode")}},getPadding(a){switch(a.toUpperCase()){case"PKCS7":return"pkcs#7";default:return"pkcs#7"}}},ee={class:"container"},te={class:"title"},ae={class:"card-header"},ne={class:"settings"},re={class:"content"},oe={class:"card-header"},se={class:"buttons"},le={class:"card-header"},de={__name:"encrypt_decrypt",setup(a){const n=f(""),e=f(""),t=f(""),{t:d}=j(),r=f("GCM"),o=f("AES"),c=[{label:"GCM",value:"GCM"},{label:"CBC",value:"CBC"},{label:"CFB",value:"CFB"},{label:"OFB",value:"OFB"},{label:"CTR",value:"CTR"},{label:"ECB",value:"ECB"}],u=E(()=>(o.value==="SM4"&&(r.value="CBC"),o.value==="SM4"?c.filter(s=>s.value==="ECB"||s.value==="CBC"):c)),v=E(()=>o.value==="AES"?d("sy_en.aesSecretKey"):d("sy_en.sm4SecretKey")),m=E(()=>o.value==="AES"?32:16),S=async()=>{if(!n.value||!t.value){e.value="Please enter both text and secret key";return}try{let s;o.value==="AES"&&r.value==="GCM"?s=await x.encrypt(n.value,t.value):o.value==="AES"?s=T.encrypt(n.value,t.value,{mode:r.value,padding:"PKCS7"}):o.value==="SM4"&&(s=G.encrypt(n.value,t.value,{mode:r.value,padding:"PKCS7"})),e.value=s}catch(s){console.error("Encryption error:",s),e.value=`Error: Unable to encrypt. ${s} Please check your input, key, and selected method.`}M("Buttons","ToggleClick",o.value+" encrypt")},z=async()=>{if(!n.value||!t.value){e.value="Please enter both text and secret key";return}try{let s;o.value==="AES"&&r.value==="GCM"?s=await x.decrypt(n.value,t.value):o.value==="AES"?s=T.decrypt(n.value,t.value,{mode:r.value,padding:"PKCS7"}):o.value==="SM4"&&(s=G.decrypt(n.value,t.value,{mode:r.value,padding:"PKCS7"})),e.value=s}catch(s){console.error("Decryption error:",s),e.value=`Error: Unable to decrypt. ${s} Please check your input, key, and selected method.`}M("Buttons","ToggleClick",o.value+" decrypted")};return(s,h)=>{const _=W,k=Z,F=J,I=X,b=N,w=R;return A(),B("div",ee,[g("div",te,C(s.$t("sy_en.title")),1),i(b,{class:"settings-card"},{header:y(()=>[g("div",ae,[g("span",null,C(s.$t("sy_en.encryptionSettings")),1)])]),default:y(()=>[g("div",ne,[i(k,{modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=p=>o.value=p),placeholder:"Select method",class:"settings-item method-select"},{default:y(()=>[i(_,{label:"AES-256",value:"AES"}),i(_,{label:"SM4",value:"SM4"})]),_:1},8,["modelValue"]),i(k,{modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=p=>r.value=p),placeholder:"Select AES mode",class:"settings-item mode-select"},{default:y(()=>[(A(!0),B(D,null,H(u.value,p=>(A(),q(_,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),i(I,{modelValue:t.value,"onUpdate:modelValue":h[2]||(h[2]=p=>t.value=p),placeholder:v.value,maxlength:m.value,"show-word-limit":"",class:"settings-item key-input"},{prefix:y(()=>[i(F,null,{default:y(()=>[i(L(Q))]),_:1})]),_:1},8,["modelValue","placeholder","maxlength"])])]),_:1}),g("div",re,[i(b,{class:"input-card"},{header:y(()=>[g("div",oe,[g("span",null,C(s.$t("sy_en.input")),1)])]),default:y(()=>[i(U,{modelValue:n.value,"onUpdate:modelValue":h[3]||(h[3]=p=>n.value=p),rows:4,placeholder:s.$t("sy_en.input_placeholer")},null,8,["modelValue","placeholder"])]),_:1}),g("div",se,[i(w,{type:"primary",class:"encode-btn",onClick:S,icon:"Lock"},{default:y(()=>[P(C(s.$t("encrypt")),1)]),_:1}),i(w,{type:"success",class:"decode-btn",onClick:z,icon:"Unlock"},{default:y(()=>[P(C(s.$t("decrypt")),1)]),_:1})]),i(b,{class:"output-card"},{header:y(()=>[g("div",le,[g("span",null,C(s.$t("sy_en.output")),1)])]),default:y(()=>[i(U,{modelValue:e.value,"onUpdate:modelValue":h[4]||(h[4]=p=>e.value=p),rows:4,readonly:"",placeholder:s.$t("sy_en.output_placeholder")},null,8,["modelValue","placeholder"])]),_:1})])])}}},he=$(de,[["__scopeId","data-v-4eb8f295"]]);export{he as default};
